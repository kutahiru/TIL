# コンポーネント

## クライアントコンポーネントとサーバーコンポーネント

サーバ側にもJSの処理を担ってもらう目的
AppRouter内のコンポーネントは基本サーバコンポーネント
'use clinet'ディレクティブをつけた場合は、クライアントコンポーネント

### 使い分け

基本はサーバー側のコンポーネントとして実装する。
インタラクティブな機能をクライアント側で実装する。
それをサーバ側でインポートする
大きなサーバコンポーネントの中でクライアントコンポーネントを使用するイメージ

#### クライアントコンポーネント

- フォーム入力
- インタラクティブなUI
- アニメーション
- ブラウザAPIの使用
- 状態管理が必要な機能
- クリックイベント処理

#### サーバコンポーネント

- データ取得と表示
- 静的なUI
- SEO重視のコンテンツ
- 大きなライブラリの使用
- DB操作
- メタデータ設定

### 組み合わせ

サーバーコンポーネントの中でクライアントコンポーネントを使用することができる。
サーバーコンポーネントでクライアントコンポーネントをimportできる。
そうすることで、サーバー側で本来は使用できないReactHookを使用できるようになる。

```tsx
// src/components/ClinetComponent.tsx
"use client"
import { useState } from "react"

export default function ClientComponent() {
  const [ count,  setCount ] = useState(0)
  console.log("client")
  return (
    <div>
      Client
      <button onClick={()=> setCount(count+1)}>Count: {count}</button>
    </div>
  )
}
```

↑のクライアントコンポーネントを↓のサーバコンポーネントでimportしている

```tsx
// src/app/rsc/page.tsx
import ClientComponent from "../../components/ClinetComponent"

export default function ServerComponent() {

  console.log("Server") //ターミナルに表示される
  return (
    <div>
      Server
      <ClientComponent/>
    </div>
  )
}
```

## リンクの使い分け

基本的に<a>タグは使わない
ページ全体がリロードされて、ステートもリセットされてしまう。

### RSC

Linkコンポーネントを使用する。
　ページ遷移先を事前にプリフェッチし高速化

```tsx
import ClientComponent from "../../components/ClinetComponent"
import Link from "next/link"

export default function ServerComponent() {

  console.log("Server") //ターミナルに表示される
  return (
    <div>
      Server
      <ClientComponent/>
      <Link href="/about">About</Link> # プリフェッチされている
    </div>
  )
}
```

### イベントを組み合わせる場合

例えばボタンクリックしたらページを表示したい
その場合はクライアント側で実装する必要がある。
専用のフックであるuseRouterを使用する

```tsx
"use client"
import { useRouter } from "next/navigation"

export default function ClientComponent() {
  const router = useRouter()

  return (
    <div>
      Client
      <button onClick={() => router.push("/about")}>buttonAbout</button>
    </div>
  )
}
```

